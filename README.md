# 商品爬虫 - 淘宝 & 京东 (Taobao & JD Crawler)

这是一个用于抓取淘宝和京东搜索结果商品信息的 Chrome 浏览器插件。它可以自动翻页、去重，并将抓取到的数据导出为 CSV 文件。

## 功能特点

- **双平台支持**：支持淘宝和京东两个电商平台
- **关键词搜索**：直接在插件中输入关键词进行搜索
- **自动翻页**：支持设置爬取页数，自动点击下一页
- **随机延时**：在翻页时增加随机延时，降低被检测风险
- **数据去重**：自动过滤重复商品
- **完整数据**：提取商品标题、价格、店铺、链接等信息
- **京东增强**：京东平台额外提取销量和好评率数据
- **CSV 导出**：一键导出包含完整信息的表格数据

## 安装说明

1. **下载插件**
   - 下载本插件的源码文件夹到本地

2. **加载扩展程序**
   - 打开 Chrome 浏览器，在地址栏输入 `chrome://extensions/` 并回车
   - 打开右上角的 **"开发者模式"** 开关
   - 点击左上角的 **"加载已解压的扩展程序"** 按钮
   - 选择包含 `manifest.json` 文件的插件文件夹

3. **验证安装**
   - 安装成功后，浏览器右上角会出现插件图标
   - 点击图标可以打开插件弹窗

## 使用指南

### 基本使用流程

1. **登录平台**
   - 确保你已经在 Chrome 浏览器中登录了 [淘宝网](https://www.taobao.com) 或 [京东](https://www.jd.com)

2. **启动插件**
   - 点击浏览器右上角的插件图标（可能在拼图图标里）

3. **设置参数**
   - **选择平台**：选择"淘宝"或"京东"
   - **关键词**：输入你想搜索的商品（例如：`机械键盘`、`羽绒服`）
   - **爬取页数**：设置想抓取的总页数（建议初次测试设为 1-2 页）
   - **随机延时**：设置翻页时的等待时间范围（建议 3-5 秒，太快容易被封）

4. **开始爬取**
   - 点击插件窗口中的 **"搜索 & 爬取"** 按钮
   - 插件会自动打开一个新的搜索标签页
   - **重要**：页面加载完成后，点击页面右侧悬浮的按钮：
     - 淘宝：橙色的 **"开始爬取 (Taobao Crawler)"** 按钮
     - 京东：红色的 **"开始爬取 (JD Crawler)"** 按钮
   - *注意：如果是多页爬取，后续翻页会自动进行，请保持标签页在前台运行，不要关闭。*

5. **导出数据**
   - 爬取完成后，会弹出提示框
   - 再次点击浏览器右上角的插件图标
   - 点击底部的 **"导出 CSV"** 按钮，即可下载 Excel 可打开的表格文件

### 数据字段说明

#### 淘宝数据格式
- **标题**：商品名称
- **价格**：商品价格
- **店铺**：店铺名称
- **链接**：商品详情页链接

#### 京东数据格式
- **标题**：商品名称
- **价格**：商品价格（支持小数）
- **店铺**：店铺名称
- **销量**：商品销量（如：4万+）
- **好评率**：好评率（如：97%）
- **链接**：商品详情页链接

## 注意事项

### 使用限制

- **反爬虫限制**：淘宝和京东都有严格的反爬虫机制。如果出现验证码或无法加载商品，请暂停一段时间再试
- **数据准确性**：插件依赖页面结构提取数据，如果平台更新了网页代码，插件可能需要更新才能继续使用
- **网络环境**：请确保网络连接稳定，以便图片和商品信息能正常加载
- **页面保持**：爬取过程中请保持标签页在前台，不要关闭或最小化

### 最佳实践

1. **首次使用**：建议先爬取 1-2 页测试，确认数据提取正常
2. **延时设置**：建议设置 3-5 秒的随机延时，避免请求过于频繁
3. **页数限制**：建议单次爬取不超过 10 页，避免被平台限制
4. **数据验证**：导出后检查数据完整性，如有缺失可能需要重新爬取

### 常见问题

**Q: 爬取完成后显示 0 个商品？**
- A: 可能是页面结构变化，请打开浏览器控制台（F12）查看错误信息，或联系开发者

**Q: 翻页失败？**
- A: 确保页面完全加载后再点击"开始爬取"按钮，如果仍然失败，请检查控制台输出

**Q: 数据不完整（很多 N/A）？**
- A: 可能是页面加载不完整，尝试等待更长时间，或刷新页面重新爬取

**Q: 导出 CSV 文件乱码？**
- A: CSV 文件使用 UTF-8 BOM 编码，Excel 应该能正常打开。如果乱码，请使用文本编辑器打开后另存为 UTF-8 格式

**Q: 插件无法加载？**
- A: 确保已启用"开发者模式"，并且选择了正确的文件夹（包含 manifest.json）

## 技术说明

### 支持的页面

- **淘宝**：
  - `https://s.taobao.com/search`
  - `https://www.taobao.com/*`

- **京东**：
  - `https://search.jd.com/*`
  - `https://list.jd.com/*`
  - `https://*.jd.com/*`（包括移动端）

### 数据存储

- 插件使用 Chrome Storage API 存储爬取的数据和设置
- 数据存储在本地，不会上传到任何服务器
- 每次开始新的搜索会清空之前的数据

### 隐私安全

- 本插件完全在本地运行，不会收集或上传任何用户数据
- 所有数据仅存储在用户的浏览器本地存储中
- 不会访问用户的个人信息或账户信息

## 更新日志

### v1.1
- ✅ 新增京东平台支持
- ✅ 新增销量和好评率数据提取（京东）
- ✅ 改进商品卡片选择器，提高提取准确性
- ✅ 优化滚动和加载逻辑，确保完整采集
- ✅ 改进翻页逻辑，支持多种翻页方式
- ✅ 增强调试信息，便于问题诊断

### v1.0
- ✅ 初始版本发布
- ✅ 支持淘宝平台
- ✅ 基本爬取和导出功能

## 开发说明

### 项目结构

```
taobao_pachong/
├── manifest.json          # 插件配置文件
├── content.js             # 淘宝页面内容脚本
├── jd-content.js          # 京东页面内容脚本
├── popup.html             # 插件弹窗界面
├── popup.js               # 弹窗逻辑
├── popup.css              # 弹窗样式
├── icons/                 # 插件图标
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md              # 说明文档
```

### 技术栈

- Chrome Extension Manifest V3
- Vanilla JavaScript
- Chrome Storage API
- Chrome Tabs API

## 免责声明

本插件仅供学习和研究使用。使用本插件时，请遵守相关法律法规和平台的使用条款：

- 请勿用于商业用途或大规模数据采集
- 请尊重平台的反爬虫机制，合理使用
- 请勿对目标网站造成过大负担
- 使用者需自行承担使用本插件的一切后果

## 许可证

本项目仅供学习交流使用。

---

**提示**：学习用，请合理使用，避免对平台造成负担。
